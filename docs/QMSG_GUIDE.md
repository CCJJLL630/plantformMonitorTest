# Qmsg酱 QQ消息通知配置指南

## 📱 Qmsg酱是什么？

Qmsg酱是一个免费的QQ消息推送服务，可以将消息发送到你的QQ好友或QQ群。

**优点**：
- ✅ 完全免费
- ✅ 配置简单（5分钟搞定）
- ✅ 支持私聊和群聊
- ✅ 无需运行额外程序

**缺点**：
- ⚠️ 需要添加机器人为QQ好友
- ⚠️ 免费版每天限制100次推送（价格监控够用）

---

## 🚀 快速配置（3步走）

### 第1步：获取Qmsg KEY（2分钟）

1. 访问 Qmsg官网：https://qmsg.zendee.cn/
2. 点击"免费使用"
3. 用QQ扫码登录
4. 进入后台，复制你的 **KEY**（格式：`数字-字母组合`，例如：`123456-abcdefgh`）

![获取KEY示意图]
```
登录后台 → 我的KEY → 复制
例如：123456-abcdefgh
```

---

### 第2步：添加Qmsg机器人（1分钟）

**方式A：发送私聊消息（推荐）**

1. 添加QQ好友：`2082184065`（Qmsg酱机器人）
2. 发送消息：`@me`
3. 看到机器人回复，说明激活成功

**方式B：发送群聊消息**

1. 把机器人 `2082184065` 拉进你的QQ群
2. 在群里发送：`@群号`（例如：`@123456789`）
3. 看到机器人回复，说明激活成功

---

### 第3步：配置config.json（1分钟）

打开你的 `config.json` 文件，找到 `notification` 部分，添加/修改：

**示例1：发送到自己（私聊）**
```json
"notification": {
    "email": {
        "enabled": true,
        // ...邮件配置...
    },
    "qmsg": {
        "enabled": true,              // 开启QQ消息通知
        "key": "123456-abcdefgh",     // 你的Qmsg KEY
        "msg_type": "send",           // send表示私聊
        "qq": ""                      // 留空表示发给自己
    }
}
```

**示例2：发送到指定QQ好友**
```json
"qmsg": {
    "enabled": true,
    "key": "123456-abcdefgh",
    "msg_type": "send",
    "qq": "987654321"                 // 填写好友的QQ号
}
```

**示例3：发送到QQ群**
```json
"qmsg": {
    "enabled": true,
    "key": "123456-abcdefgh",
    "msg_type": "group",              // group表示群聊
    "qq": "123456789"                 // 填写群号
}
```

---

## ✅ 测试配置

配置完成后，运行程序测试：

```bash
python main.py
```

如果发现价格低于目标价格，你会收到QQ消息：

```
【价格预警】宙斯x27电击枪 | 鼾龙传说 (久经沙场)

发现低于目标价格 ¥350.00 的商品，共 5 个

价格详情：
- 平台: buff
  商品: 宙斯x27电击枪 | 鼾龙传说 (久经沙场)
  价格: ¥314.25
  磨损: 0.203776
  链接: https://buff.163.com/goods/968354
...
```

---

## 📋 配置参数说明

| 参数 | 必填 | 说明 | 示例 |
|------|------|------|------|
| `enabled` | 是 | 是否启用QQ消息通知 | `true` 或 `false` |
| `key` | 是 | Qmsg KEY | `123456-abcdefgh` |
| `msg_type` | 否 | 消息类型 | `send`（私聊）或 `group`（群聊），默认`send` |
| `qq` | 否 | 目标QQ号或群号 | 留空=发给自己，填QQ号=发给指定人/群 |

---

## 🔧 常见问题

### Q1：没有收到QQ消息？

**检查清单**：
- [ ] `enabled` 是否为 `true`
- [ ] `key` 是否正确（从Qmsg官网复制）
- [ ] 是否已添加机器人为好友并发送 `@me` 激活
- [ ] 程序是否找到了低于目标价格的商品（查看日志）
- [ ] 检查 `logs/monitor.log` 是否有"Qmsg酱消息发送成功"

### Q2：提示"KEY未配置"？

确保 `config.json` 中的 `key` 字段已正确填写。

### Q3：提示发送失败？

可能原因：
1. KEY错误，重新从官网复制
2. 未激活机器人（未发送 `@me` 或 `@群号`）
3. 超过每日限制（免费版100次）
4. 网络问题，检查网络连接

### Q4：消息内容被截断？

Qmsg限制单条消息最长1000字符，超出部分会自动截断并添加"..."。

### Q5：如何同时发送到多个QQ号或群？

**方案：使用多配置（数组格式）**

程序支持配置多个Qmsg，可以同时发送到：
- 多个QQ好友
- 多个QQ群
- QQ好友 + QQ群（混合）

详见下面的"高级配置"章节。

---

## 🎓 高级配置：多Qmsg配置

### 使用场景

如果你需要：
- 同时发送到多个QQ好友
- 同时发送到多个QQ群
- 发送到好友的同时也发送到群

可以使用**数组格式**配置多个Qmsg。

### 配置方法

将 `qmsg` 从对象改为数组：

```json
"notification": {
    "qmsg": [
        {
            "enabled": true,
            "key": "123456-aaaaaaaa",
            "msg_type": "send",
            "qq": "111111111"
        },
        {
            "enabled": true,
            "key": "789012-bbbbbbbb",
            "msg_type": "group",
            "qq": "222222222"
        },
        {
            "enabled": false,
            "key": "345678-cccccccc",
            "msg_type": "send",
            "qq": ""
        }
    ]
}
```

### 配置示例

**示例1：同时发送给自己和2个群**
```json
"qmsg": [
    {
        "enabled": true,
        "key": "YOUR_KEY_1",
        "msg_type": "send",
        "qq": ""                    // 发给自己
    },
    {
        "enabled": true,
        "key": "YOUR_KEY_2",
        "msg_type": "group",
        "qq": "123456789"          // 发到群1
    },
    {
        "enabled": true,
        "key": "YOUR_KEY_3",
        "msg_type": "group",
        "qq": "987654321"          // 发到群2
    }
]
```

**示例2：发送到多个好友**
```json
"qmsg": [
    {
        "enabled": true,
        "key": "YOUR_KEY_1",
        "msg_type": "send",
        "qq": "111111111"          // 好友A
    },
    {
        "enabled": true,
        "key": "YOUR_KEY_2",
        "msg_type": "send",
        "qq": "222222222"          // 好友B
    }
]
```

### 注意事项

1. **每个配置需要独立的KEY**：不同的Qmsg账号有不同的KEY
2. **每个目标需要激活**：每个QQ号/群号都需要发送激活消息
3. **可以选择性启用**：通过 `enabled` 字段控制是否发送
4. **日志会显示编号**：如"Qmsg酱消息发送成功 #1"，"Qmsg酱消息发送成功 #2"

### 兼容性

- ✅ 支持**单个配置**（对象格式）
- ✅ 支持**多个配置**（数组格式）
- ✅ 自动识别格式，无需额外配置

旧的配置（对象格式）依然有效：
```json
"qmsg": {
    "enabled": true,
    "key": "YOUR_KEY",
    "msg_type": "send",
    "qq": ""
}
```

---

## 💡 使用建议

**推荐配置组合**：

```json
"notification": {
    "email": {
        "enabled": true,
        // 邮件作为主要通知方式，保存完整历史
    },
    "qmsg": {
        "enabled": true,
        // QQ消息作为实时提醒，手机立即查看
    }
}
```

**优点**：
- 邮件保存完整历史，方便查询
- QQ消息实时推送，不错过机会
- 双重保障，更可靠

---

## 🔗 相关链接

- Qmsg官网：https://qmsg.zendee.cn/
- Qmsg使用文档：https://qmsg.zendee.cn/docs
- 机器人QQ：2082184065

---

## 🎯 快速回顾

配置Qmsg只需3步：

1. **获取KEY** → 访问官网，QQ登录，复制KEY
2. **激活机器人** → 加好友 `2082184065`，发送 `@me`
3. **配置文件** → 在 `config.json` 中填写KEY

完成后，每次发现低价商品，都会自动发QQ消息提醒你！
